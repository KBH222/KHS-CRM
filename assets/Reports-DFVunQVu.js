import{j as t}from"./ui-vendor-DuzoyoLP.js";import{r as i}from"./react-vendor-BLXwT7zj.js";import{a as j,c as f}from"./localStorage-DKzdD8oH.js";import"./index-DEcLH6Mq.js";import"./utils-vendor-BiZXfEo0.js";const D=()=>{const[h,u]=i.useState([]),[v,b]=i.useState([]),[l,m]=i.useState("month"),[p,c]=i.useState(()=>{const e=new Date;return e.setDate(1),e.toISOString().split("T")[0]}),[x,g]=i.useState(()=>{const e=new Date;return e.setMonth(e.getMonth()+1),e.setDate(0),e.toISOString().split("T")[0]});i.useEffect(()=>{u(j.getAll()),b(f.getAll())},[]),i.useEffect(()=>{const e=new Date;let s=new Date,r=new Date;switch(l){case"week":s.setDate(e.getDate()-e.getDay()),r.setDate(s.getDate()+6);break;case"month":s=new Date(e.getFullYear(),e.getMonth(),1),r=new Date(e.getFullYear(),e.getMonth()+1,0);break;case"quarter":const a=Math.floor(e.getMonth()/3);s=new Date(e.getFullYear(),a*3,1),r=new Date(e.getFullYear(),a*3+3,0);break;case"year":s=new Date(e.getFullYear(),0,1),r=new Date(e.getFullYear(),11,31);break;case"custom":return}c(s.toISOString().split("T")[0]),g(r.toISOString().split("T")[0])},[l]);const n=h.filter(e=>{const s=new Date(e.startDate),r=new Date(p),a=new Date(x);return a.setHours(23,59,59,999),s>=r&&s<=a}),o={totalJobs:n.length,completedJobs:n.filter(e=>e.status==="completed").length,inProgressJobs:n.filter(e=>e.status==="in-progress").length,pendingJobs:n.filter(e=>e.status==="pending"||!e.status).length,totalRevenue:n.reduce((e,s)=>e+(s.price||0),0),avgJobValue:n.length>0?n.reduce((e,s)=>e+(s.price||0),0)/n.length:0,totalCustomers:new Set(n.map(e=>e.customerId)).size,jobsByWorker:{},jobsByCustomer:{},jobsByMonth:{}};n.forEach(e=>{(e.workers||[]).forEach(s=>{o.jobsByWorker[s]||(o.jobsByWorker[s]=0),o.jobsByWorker[s]++})}),n.forEach(e=>{const s=e.customerName||"Unknown";o.jobsByCustomer[s]||(o.jobsByCustomer[s]=0),o.jobsByCustomer[s]++}),n.forEach(e=>{const s=new Date(e.startDate),r=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;o.jobsByMonth[r]||(o.jobsByMonth[r]=0),o.jobsByMonth[r]++});const d=({title:e,value:s,subtitle:r,color:a="#3B82F6"})=>t.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",borderLeft:`4px solid ${a}`},children:[t.jsx("h3",{style:{fontSize:"14px",color:"#6B7280",margin:"0 0 8px 0",fontWeight:"500"},children:e}),t.jsx("p",{style:{fontSize:"28px",fontWeight:"bold",margin:"0 0 4px 0",color:"#111827"},children:s}),r&&t.jsx("p",{style:{fontSize:"12px",color:"#9CA3AF",margin:0},children:r})]}),y=[{value:"week",label:"This Week"},{value:"month",label:"This Month"},{value:"quarter",label:"This Quarter"},{value:"year",label:"This Year"},{value:"custom",label:"Custom Range"}];return t.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"20px"},children:[t.jsx("div",{style:{marginBottom:"24px"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("button",{onClick:()=>window.history.back(),style:{background:"none",border:"none",padding:"8px",cursor:"pointer",display:"flex",alignItems:"center",color:"#6B7280",borderRadius:"6px"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#F3F4F6",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:t.jsx("svg",{style:{width:"28px",height:"28px"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",margin:"0 0 8px 0"},children:"Reports & Analytics"}),t.jsx("p",{style:{color:"#6B7280",margin:0},children:"Track your business performance and insights"})]})]})}),t.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"16px",marginBottom:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap"},children:[t.jsx("label",{style:{fontWeight:"500",color:"#374151"},children:"Time Range:"}),t.jsx("select",{value:l,onChange:e=>m(e.target.value),style:{padding:"8px 12px",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:y.map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))}),l==="custom"&&t.jsxs(t.Fragment,{children:[t.jsx("input",{type:"date",value:p,onChange:e=>c(e.target.value),style:{padding:"8px 12px",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"14px"}}),t.jsx("span",{style:{color:"#6B7280"},children:"to"}),t.jsx("input",{type:"date",value:x,onChange:e=>g(e.target.value),style:{padding:"8px 12px",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"14px"}})]}),t.jsxs("span",{style:{marginLeft:"auto",fontSize:"14px",color:"#6B7280"},children:[new Date(p).toLocaleDateString()," - ",new Date(x).toLocaleDateString()]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px",marginBottom:"24px"},children:[t.jsx(d,{title:"Total Jobs",value:o.totalJobs,subtitle:`${o.completedJobs} completed`,color:"#3B82F6"}),t.jsx(d,{title:"Total Revenue",value:`$${o.totalRevenue.toLocaleString()}`,subtitle:`Avg: $${Math.round(o.avgJobValue).toLocaleString()}`,color:"#10B981"}),t.jsx(d,{title:"Active Customers",value:o.totalCustomers,subtitle:"Unique customers",color:"#8B5CF6"}),t.jsx(d,{title:"Completion Rate",value:`${o.totalJobs>0?Math.round(o.completedJobs/o.totalJobs*100):0}%`,subtitle:`${o.inProgressJobs} in progress`,color:"#F59E0B"})]}),t.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",marginBottom:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[t.jsx("h2",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Job Status Breakdown"}),t.jsx("div",{style:{display:"flex",gap:"24px",flexWrap:"wrap"},children:t.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#374151"},children:"Completed"}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:o.completedJobs})]}),t.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"#E5E7EB",borderRadius:"4px",overflow:"hidden"},children:t.jsx("div",{style:{width:`${o.totalJobs>0?o.completedJobs/o.totalJobs*100:0}%`,height:"100%",backgroundColor:"#10B981",transition:"width 0.3s"}})})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#374151"},children:"In Progress"}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:o.inProgressJobs})]}),t.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"#E5E7EB",borderRadius:"4px",overflow:"hidden"},children:t.jsx("div",{style:{width:`${o.totalJobs>0?o.inProgressJobs/o.totalJobs*100:0}%`,height:"100%",backgroundColor:"#3B82F6",transition:"width 0.3s"}})})]}),t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#374151"},children:"Pending"}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:o.pendingJobs})]}),t.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"#E5E7EB",borderRadius:"4px",overflow:"hidden"},children:t.jsx("div",{style:{width:`${o.totalJobs>0?o.pendingJobs/o.totalJobs*100:0}%`,height:"100%",backgroundColor:"#F59E0B",transition:"width 0.3s"}})})]})]})})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:"24px"},children:[t.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[t.jsx("h2",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Jobs by Worker"}),Object.keys(o.jobsByWorker).length>0?t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:Object.entries(o.jobsByWorker).sort(([,e],[,s])=>s-e).map(([e,s])=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px solid #F3F4F6"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#374151"},children:e}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"600",backgroundColor:"#E0E7FF",color:"#3730A3",padding:"2px 8px",borderRadius:"12px"},children:s})]},e))}):t.jsx("p",{style:{color:"#9CA3AF",fontSize:"14px",textAlign:"center",padding:"20px 0"},children:"No worker data available"})]}),t.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[t.jsx("h2",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Top Customers"}),Object.keys(o.jobsByCustomer).length>0?t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:Object.entries(o.jobsByCustomer).sort(([,e],[,s])=>s-e).slice(0,5).map(([e,s])=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px solid #F3F4F6"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#374151",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"70%"},children:e}),t.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",backgroundColor:"#D1FAE5",color:"#065F46",padding:"2px 8px",borderRadius:"12px"},children:[s," jobs"]})]},e))}):t.jsx("p",{style:{color:"#9CA3AF",fontSize:"14px",textAlign:"center",padding:"20px 0"},children:"No customer data available"})]})]})]})};export{D as default};
//# sourceMappingURL=Reports-DFVunQVu.js.map
