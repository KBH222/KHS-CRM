{"version":3,"file":"Login-DXABXAaJ.js","sources":["../../src/pages/Login.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth, useBiometric } from '../stores/auth.store';\nimport { offlineAuthService } from '../services/offline-auth.service';\nimport { useOnlineStatus } from '../hooks/useOnlineStatus';\n\nconst Login = () => {\n  const navigate = useNavigate();\n  const { login } = useAuth();\n  const { isBiometricEnabled, biometricLogin } = useBiometric();\n  const isOnline = useOnlineStatus();\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [biometricSupported, setBiometricSupported] = useState(false);\n  const [enableBiometricOption, setEnableBiometricOption] = useState(false);\n  \n  const [formData, setFormData] = useState({\n    email: '',\n    password: '',\n    rememberMe: false,\n  });\n\n  useEffect(() => {\n    // Check if biometric authentication is supported\n    const checkBiometricSupport = async () => {\n      const supported = await offlineAuthService.isBiometricSupported();\n      setBiometricSupported(supported);\n    };\n    \n    checkBiometricSupport();\n  }, []);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setIsLoading(true);\n\n    try {\n      await login(\n        {\n          email: formData.email,\n          password: formData.password,\n          rememberMe: formData.rememberMe,\n        },\n        enableBiometricOption && biometricSupported\n      );\n      navigate('/dashboard');\n    } catch (err: any) {\n      setError(err.message || 'Invalid email or password');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleBiometricLogin = async () => {\n    if (!isBiometricEnabled) return;\n    \n    setError('');\n    setIsLoading(true);\n\n    try {\n      await biometricLogin();\n      navigate('/dashboard');\n    } catch (err: any) {\n      setError(err.message || 'Biometric authentication failed');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center px-4\">\n      <div className=\"max-w-md w-full space-y-8\">\n        {/* Logo/Title */}\n        <div className=\"text-center\">\n          <h1 className=\"text-3xl font-bold text-gray-900\">KHS CRM</h1>\n          <p className=\"mt-2 text-gray-600\">Sign in to your account</p>\n        </div>\n\n        {/* Connection Status */}\n        <div className={`border rounded-lg p-4 ${\n          isOnline \n            ? 'bg-green-50 border-green-200' \n            : 'bg-yellow-50 border-yellow-200'\n        }`}>\n          <div className=\"flex items-center\">\n            <div className={`w-2 h-2 rounded-full mr-2 ${\n              isOnline ? 'bg-green-400' : 'bg-yellow-400'\n            }`}></div>\n            <p className={`text-sm font-medium ${\n              isOnline ? 'text-green-900' : 'text-yellow-900'\n            }`}>\n              {isOnline ? 'Online' : 'Offline Mode'}\n            </p>\n          </div>\n          {!isOnline && (\n            <p className=\"text-xs text-yellow-700 mt-1\">\n              You can still sign in with stored credentials\n            </p>\n          )}\n        </div>\n        \n        {/* Demo Credentials */}\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n          <p className=\"text-sm font-medium text-blue-900 mb-2\">Demo Credentials:</p>\n          <div className=\"space-y-1 text-sm text-blue-800\">\n            <p>Owner: owner@khs.com / password123</p>\n            <p>Worker: worker@khs.com / password123</p>\n          </div>\n        </div>\n        \n        {/* Biometric Login Option */}\n        {isBiometricEnabled && biometricSupported && (\n          <div className=\"text-center\">\n            <button\n              onClick={handleBiometricLogin}\n              disabled={isLoading}\n              className=\"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n              </svg>\n              {isLoading ? 'Authenticating...' : 'Sign in with Biometric'}\n            </button>\n            <p className=\"text-xs text-gray-500 mt-2\">Or sign in with your password below</p>\n          </div>\n        )}\n\n        <form className=\"mt-8 space-y-6\" onSubmit={handleSubmit}>\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n              <p className=\"text-sm text-red-600\">{error}</p>\n            </div>\n          )}\n\n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\n                Email address\n              </label>\n              <input\n                id=\"email\"\n                name=\"email\"\n                type=\"email\"\n                autoComplete=\"email\"\n                required\n                value={formData.email}\n                onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                className=\"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\n                placeholder=\"Enter your email\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700\">\n                Password\n              </label>\n              <input\n                id=\"password\"\n                name=\"password\"\n                type=\"password\"\n                autoComplete=\"current-password\"\n                required\n                value={formData.password}\n                onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                className=\"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\n                placeholder=\"Enter your password\"\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center\">\n              <input\n                id=\"remember-me\"\n                name=\"remember-me\"\n                type=\"checkbox\"\n                checked={formData.rememberMe}\n                onChange={(e) => setFormData({ ...formData, rememberMe: e.target.checked })}\n                className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n              />\n              <label htmlFor=\"remember-me\" className=\"ml-2 block text-sm text-gray-900\">\n                Remember me for 30 days\n              </label>\n            </div>\n            \n            {biometricSupported && !isBiometricEnabled && (\n              <div className=\"flex items-center\">\n                <input\n                  id=\"enable-biometric\"\n                  name=\"enable-biometric\"\n                  type=\"checkbox\"\n                  checked={enableBiometricOption}\n                  onChange={(e) => setEnableBiometricOption(e.target.checked)}\n                  className=\"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded\"\n                />\n                <label htmlFor=\"enable-biometric\" className=\"ml-2 block text-sm text-gray-900\">\n                  Enable biometric login (fingerprint/face ID)\n                </label>\n              </div>\n            )}\n          </div>\n\n          <button\n            type=\"submit\"\n            disabled={isLoading}\n            className=\"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {isLoading ? 'Signing in...' : 'Sign in'}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;"],"names":["Login","navigate","useNavigate","login","useAuth","isBiometricEnabled","biometricLogin","useBiometric","isOnline","useOnlineStatus","isLoading","setIsLoading","useState","error","setError","biometricSupported","setBiometricSupported","enableBiometricOption","setEnableBiometricOption","formData","setFormData","useEffect","supported","offlineAuthService","handleSubmit","e","err","handleBiometricLogin","jsxs","jsx"],"mappings":"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"}