{"version":3,"file":"worker.service-fRvciyjk.js","sources":["../../src/services/worker.service.ts"],"sourcesContent":["/**\n * Worker Service\n * Manages worker data with localStorage persistence\n */\n\nexport interface Worker {\n  id: string;\n  name: string;\n  fullName: string;\n  phone: string;\n  email: string;\n  specialty: string;\n  status: 'Available' | 'On Job' | 'Off Duty';\n  currentJob?: string | null;\n  color: string;\n  notes?: string;\n  timesheet?: {\n    [key: string]: {\n      startTime: string;\n      endTime: string;\n      lunchMinutes: number;\n      job: string;\n      workType: string;\n      totalHours: number;\n    }\n  };\n}\n\nconst STORAGE_KEY = 'khs-crm-workers';\n\n// Default workers\nconst defaultWorkers: Worker[] = [\n  {\n    id: 'KBH',\n    name: 'KBH',\n    fullName: 'Keith B. Henderson',\n    phone: '(555) 111-2222',\n    email: 'kbh@khsconstruction.com',\n    specialty: 'General Construction',\n    status: 'Available',\n    currentJob: null,\n    color: '#3B82F6'\n  },\n  {\n    id: 'ISA',\n    name: 'ISA',\n    fullName: 'Isabella A. Rodriguez',\n    phone: '(555) 333-4444',\n    email: 'isa@khsconstruction.com',\n    specialty: 'Finish Work',\n    status: 'On Job',\n    currentJob: 'Kitchen Remodel - Sarah Johnson',\n    color: '#10B981'\n  },\n  {\n    id: 'TYL',\n    name: 'TYL',\n    fullName: 'Tyler L. Mitchell',\n    phone: '(555) 555-6666',\n    email: 'tyl@khsconstruction.com',\n    specialty: 'Carpentry',\n    status: 'On Job',\n    currentJob: 'Deck Installation - Mike Davis',\n    color: '#F59E0B'\n  }\n];\n\n// Available colors for workers\nexport const workerColors = [\n  '#3B82F6', // Blue\n  '#10B981', // Green\n  '#F59E0B', // Yellow\n  '#EF4444', // Red\n  '#8B5CF6', // Purple\n  '#EC4899', // Pink\n  '#14B8A6', // Teal\n  '#6366F1', // Indigo\n  '#F97316', // Orange\n  '#84CC16', // Lime\n];\n\nclass WorkerService {\n  private workers: Worker[] = [];\n\n  constructor() {\n    this.loadWorkers();\n  }\n\n  private loadWorkers() {\n    try {\n      const stored = localStorage.getItem(STORAGE_KEY);\n      if (stored) {\n        this.workers = JSON.parse(stored);\n      } else {\n        this.workers = defaultWorkers;\n        this.saveWorkers();\n      }\n    } catch (error) {\n      console.error('Failed to load workers:', error);\n      this.workers = defaultWorkers;\n    }\n  }\n\n  private saveWorkers() {\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(this.workers));\n    } catch (error) {\n      console.error('Failed to save workers:', error);\n    }\n  }\n\n  getAll(): Worker[] {\n    return [...this.workers];\n  }\n\n  getById(id: string): Worker | undefined {\n    return this.workers.find(w => w.id === id);\n  }\n\n  getByInitials(initials: string): Worker | undefined {\n    return this.workers.find(w => w.name === initials);\n  }\n\n  create(worker: Omit<Worker, 'id'>): Worker {\n    const newWorker: Worker = {\n      ...worker,\n      id: this.generateId(worker.name)\n    };\n    this.workers.push(newWorker);\n    this.saveWorkers();\n    return newWorker;\n  }\n\n  update(id: string, updates: Partial<Worker>): Worker | undefined {\n    const index = this.workers.findIndex(w => w.id === id);\n    if (index === -1) return undefined;\n\n    this.workers[index] = { ...this.workers[index], ...updates };\n    this.saveWorkers();\n    return this.workers[index];\n  }\n\n  delete(id: string): boolean {\n    const index = this.workers.findIndex(w => w.id === id);\n    if (index === -1) return false;\n\n    this.workers.splice(index, 1);\n    this.saveWorkers();\n    return true;\n  }\n\n  private generateId(name: string): string {\n    // Try to use the initials as ID\n    const initials = name.split(' ')\n      .map(word => word[0])\n      .join('')\n      .toUpperCase();\n    \n    // Check if initials are already taken\n    let id = initials;\n    let counter = 1;\n    while (this.workers.some(w => w.id === id)) {\n      id = `${initials}${counter}`;\n      counter++;\n    }\n    return id;\n  }\n\n  // Get next available color\n  getNextColor(): string {\n    const usedColors = this.workers.map(w => w.color);\n    const availableColor = workerColors.find(color => !usedColors.includes(color));\n    return availableColor || workerColors[0];\n  }\n\n  // Utility to format phone number\n  formatPhone(phone: string): string {\n    const cleaned = phone.replace(/\\D/g, '');\n    if (cleaned.length === 10) {\n      return `(${cleaned.slice(0, 3)}) ${cleaned.slice(3, 6)}-${cleaned.slice(6)}`;\n    }\n    return phone;\n  }\n}\n\nexport const workerService = new WorkerService();"],"names":["STORAGE_KEY","defaultWorkers","workerColors","WorkerService","__publicField","stored","error","id","w","initials","worker","newWorker","updates","index","name","word","counter","usedColors","color","phone","cleaned","workerService"],"mappings":"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"}