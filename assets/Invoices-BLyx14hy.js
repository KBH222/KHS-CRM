import{j as e}from"./ui-vendor-DuzoyoLP.js";import{u as N,r as l}from"./react-vendor-BLXwT7zj.js";import{a as T,c as L}from"./localStorage-DKzdD8oH.js";import"./index-DEcLH6Mq.js";import"./utils-vendor-BiZXfEo0.js";const P=()=>{const m=N(),[a,b]=l.useState([]),[I,u]=l.useState(!1),[x,E]=l.useState([]),[$,B]=l.useState([]),[p,C]=l.useState("all"),[c,j]=l.useState(null),[i,s]=l.useState({jobId:"",invoiceNumber:"",issueDate:new Date().toISOString().split("T")[0],dueDate:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],lineItems:[],subtotal:0,tax:0,taxRate:.08,total:0,notes:"",status:"draft",paidDate:null});l.useEffect(()=>{const t=localStorage.getItem("khs_crm_invoices");t&&b(JSON.parse(t)),E(T.getAll()),B(L.getAll())},[]),l.useEffect(()=>{if(!i.invoiceNumber){const t=a.length+1001;s(n=>({...n,invoiceNumber:`INV-${t}`}))}},[a.length]);const g=t=>{localStorage.setItem("khs_crm_invoices",JSON.stringify(t)),b(t)},z=t=>{const n=x.find(o=>o.id===t);n&&(j(n),s(o=>({...o,jobId:t,lineItems:[{id:Date.now(),description:n.title,quantity:1,rate:n.price||0,amount:n.price||0}]})),f([{id:Date.now(),description:n.title,quantity:1,rate:n.price||0,amount:n.price||0}]))},h=(t,n,o)=>{const r=[...i.lineItems];r[t][n]=o,(n==="quantity"||n==="rate")&&(r[t].amount=r[t].quantity*r[t].rate),s(d=>({...d,lineItems:r})),f(r)},D=()=>{const t={id:Date.now(),description:"",quantity:1,rate:0,amount:0},n=[...i.lineItems,t];s(o=>({...o,lineItems:n}))},k=t=>{const n=i.lineItems.filter((o,r)=>r!==t);s(o=>({...o,lineItems:n})),f(n)},f=t=>{const n=t.reduce((d,F)=>d+F.amount,0),o=n*i.taxRate,r=n+o;s(d=>({...d,subtotal:n,tax:o,total:r}))},W=()=>{var o,r;const t={...i,id:Date.now().toString(),createdAt:new Date().toISOString(),customer:c?(o=x.find(d=>d.id===c.id))==null?void 0:o.customerName:"",customerId:c?(r=x.find(d=>d.id===c.id))==null?void 0:r.customerId:""},n=[...a,t];g(n),u(!1),S()},S=()=>{s({jobId:"",invoiceNumber:"",issueDate:new Date().toISOString().split("T")[0],dueDate:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],lineItems:[],subtotal:0,tax:0,taxRate:.08,total:0,notes:"",status:"draft",paidDate:null}),j(null)},v=(t,n)=>{const o=a.map(r=>r.id===t?{...r,status:n,paidDate:n==="paid"?new Date().toISOString():r.paidDate}:r);g(o)},A=t=>{if(confirm("Are you sure you want to delete this invoice?")){const n=a.filter(o=>o.id!==t);g(n)}},y=a.filter(t=>p==="all"?!0:p==="overdue"?t.status!=="paid"&&new Date(t.dueDate)<new Date:t.status===p),w=(t,n)=>t==="paid"?"#10B981":t==="sent"&&new Date(n)<new Date?"#EF4444":t==="sent"?"#3B82F6":"#6B7280",R=(t,n)=>t==="paid"?"Paid":t==="sent"&&new Date(n)<new Date?"Overdue":t==="sent"?"Sent":"Draft";return e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("button",{onClick:()=>m("/dashboard"),style:{background:"none",border:"none",padding:"8px",cursor:"pointer",display:"flex",alignItems:"center",color:"#6B7280",borderRadius:"6px"},onMouseEnter:t=>t.currentTarget.style.backgroundColor="#F3F4F6",onMouseLeave:t=>t.currentTarget.style.backgroundColor="transparent",children:e.jsx("svg",{style:{width:"28px",height:"28px"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",margin:"0 0 8px 0"},children:"Invoices"}),e.jsx("p",{style:{color:"#6B7280",margin:0},children:"Manage invoices and payment tracking"})]})]}),e.jsx("button",{onClick:()=>u(!0),style:{padding:"10px 20px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"+ New Invoice"})]}),e.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",flexWrap:"wrap"},children:["all","draft","sent","paid","overdue"].map(t=>e.jsxs("button",{onClick:()=>C(t),style:{padding:"8px 16px",backgroundColor:p===t?"#3B82F6":"#E5E7EB",color:p===t?"white":"#374151",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",textTransform:"capitalize"},children:[t==="all"?"All Invoices":t,t!=="all"&&` (${a.filter(n=>t==="overdue"?n.status!=="paid"&&new Date(n.dueDate)<new Date:n.status===t).length})`]},t))}),e.jsx("div",{style:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",overflow:"hidden"},children:y.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"#9CA3AF"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"ðŸ“„"}),e.jsx("p",{style:{fontSize:"16px",margin:"0 0 8px 0"},children:"No invoices found"}),e.jsx("p",{style:{fontSize:"14px",margin:0},children:"Create your first invoice to get started"})]}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid #E5E7EB"},children:[e.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:"12px",fontWeight:"600",color:"#6B7280"},children:"Invoice #"}),e.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:"12px",fontWeight:"600",color:"#6B7280"},children:"Customer"}),e.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:"12px",fontWeight:"600",color:"#6B7280"},children:"Amount"}),e.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:"12px",fontWeight:"600",color:"#6B7280"},children:"Issue Date"}),e.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:"12px",fontWeight:"600",color:"#6B7280"},children:"Due Date"}),e.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:"12px",fontWeight:"600",color:"#6B7280"},children:"Status"}),e.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:"12px",fontWeight:"600",color:"#6B7280"},children:"Actions"})]})}),e.jsx("tbody",{children:y.map((t,n)=>e.jsxs("tr",{style:{borderBottom:n<y.length-1?"1px solid #E5E7EB":"none"},children:[e.jsx("td",{style:{padding:"16px",fontSize:"14px",fontWeight:"500"},children:t.invoiceNumber}),e.jsx("td",{style:{padding:"16px",fontSize:"14px",color:"#374151"},children:t.customer}),e.jsxs("td",{style:{padding:"16px",fontSize:"14px",fontWeight:"600"},children:["$",t.total.toFixed(2)]}),e.jsx("td",{style:{padding:"16px",fontSize:"14px",color:"#6B7280"},children:new Date(t.issueDate).toLocaleDateString()}),e.jsx("td",{style:{padding:"16px",fontSize:"14px",color:"#6B7280"},children:new Date(t.dueDate).toLocaleDateString()}),e.jsx("td",{style:{padding:"16px"},children:e.jsx("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"500",backgroundColor:`${w(t.status,t.dueDate)}20`,color:w(t.status,t.dueDate)},children:R(t.status,t.dueDate)})}),e.jsx("td",{style:{padding:"16px",textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t.status==="draft"&&e.jsx("button",{onClick:()=>v(t.id,"sent"),style:{padding:"6px 12px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Send"}),t.status==="sent"&&e.jsx("button",{onClick:()=>v(t.id,"paid"),style:{padding:"6px 12px",backgroundColor:"#10B981",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Mark Paid"}),e.jsx("button",{onClick:()=>m(`/invoices/${t.id}`),style:{padding:"6px 12px",backgroundColor:"#E5E7EB",color:"#374151",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"View"}),e.jsx("button",{onClick:()=>A(t.id),style:{padding:"6px 12px",backgroundColor:"#FEE2E2",color:"#DC2626",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Delete"})]})})]},t.id))})]})}),I&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"24px",maxWidth:"800px",width:"90%",maxHeight:"90vh",overflowY:"auto"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px"},children:"Create New Invoice"}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Select Job"}),e.jsxs("select",{value:i.jobId,onChange:t=>z(t.target.value),style:{width:"100%",padding:"10px",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"14px"},children:[e.jsx("option",{value:"",children:"Select a job..."}),x.filter(t=>t.status==="completed").map(t=>e.jsxs("option",{value:t.id,children:[t.title," - ",t.customerName," ($",t.price||0,")"]},t.id))]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Invoice Number"}),e.jsx("input",{type:"text",value:i.invoiceNumber,onChange:t=>s(n=>({...n,invoiceNumber:t.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Issue Date"}),e.jsx("input",{type:"date",value:i.issueDate,onChange:t=>s(n=>({...n,issueDate:t.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"14px"}})]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Due Date"}),e.jsx("input",{type:"date",value:i.dueDate,onChange:t=>s(n=>({...n,dueDate:t.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"14px"}})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Line Items"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid #E5E7EB"},children:[e.jsx("th",{style:{padding:"8px",textAlign:"left",fontSize:"12px",fontWeight:"600"},children:"Description"}),e.jsx("th",{style:{padding:"8px",textAlign:"center",fontSize:"12px",fontWeight:"600",width:"100px"},children:"Qty"}),e.jsx("th",{style:{padding:"8px",textAlign:"center",fontSize:"12px",fontWeight:"600",width:"120px"},children:"Rate"}),e.jsx("th",{style:{padding:"8px",textAlign:"right",fontSize:"12px",fontWeight:"600",width:"120px"},children:"Amount"}),e.jsx("th",{style:{width:"40px"}})]})}),e.jsx("tbody",{children:i.lineItems.map((t,n)=>e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px"},children:e.jsx("input",{type:"text",value:t.description,onChange:o=>h(n,"description",o.target.value),placeholder:"Item description",style:{width:"100%",padding:"8px",border:"1px solid #E5E7EB",borderRadius:"4px",fontSize:"14px"}})}),e.jsx("td",{style:{padding:"8px"},children:e.jsx("input",{type:"number",value:t.quantity,onChange:o=>h(n,"quantity",parseFloat(o.target.value)||0),style:{width:"100%",padding:"8px",border:"1px solid #E5E7EB",borderRadius:"4px",fontSize:"14px",textAlign:"center"}})}),e.jsx("td",{style:{padding:"8px"},children:e.jsx("input",{type:"number",value:t.rate,onChange:o=>h(n,"rate",parseFloat(o.target.value)||0),placeholder:"0.00",style:{width:"100%",padding:"8px",border:"1px solid #E5E7EB",borderRadius:"4px",fontSize:"14px",textAlign:"right"}})}),e.jsxs("td",{style:{padding:"8px",textAlign:"right",fontSize:"14px",fontWeight:"500"},children:["$",t.amount.toFixed(2)]}),e.jsx("td",{style:{padding:"8px"},children:e.jsx("button",{onClick:()=>k(n),style:{padding:"4px 8px",backgroundColor:"#FEE2E2",color:"#DC2626",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Ã—"})})]},t.id))})]}),e.jsx("button",{onClick:D,style:{marginTop:"12px",padding:"8px 16px",backgroundColor:"#E5E7EB",color:"#374151",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:"+ Add Line Item"})]}),e.jsxs("div",{style:{borderTop:"1px solid #E5E7EB",paddingTop:"16px",marginBottom:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Subtotal:"}),e.jsxs("span",{style:{fontSize:"14px",fontWeight:"500"},children:["$",i.subtotal.toFixed(2)]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Tax (8%):"}),e.jsxs("span",{style:{fontSize:"14px",fontWeight:"500"},children:["$",i.tax.toFixed(2)]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderTop:"1px solid #E5E7EB",paddingTop:"8px"},children:[e.jsx("span",{style:{fontSize:"16px",fontWeight:"600"},children:"Total:"}),e.jsxs("span",{style:{fontSize:"16px",fontWeight:"600"},children:["$",i.total.toFixed(2)]})]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Notes"}),e.jsx("textarea",{value:i.notes,onChange:t=>s(n=>({...n,notes:t.target.value})),placeholder:"Additional notes or payment terms...",rows:3,style:{width:"100%",padding:"10px",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"14px",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{u(!1),S()},style:{padding:"10px 20px",backgroundColor:"#E5E7EB",color:"#374151",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:"Cancel"}),e.jsx("button",{onClick:W,disabled:i.lineItems.length===0,style:{padding:"10px 20px",backgroundColor:i.lineItems.length===0?"#9CA3AF":"#3B82F6",color:"white",border:"none",borderRadius:"6px",cursor:i.lineItems.length===0?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500"},children:"Create Invoice"})]})]})})]})};export{P as default};
//# sourceMappingURL=Invoices-BLyx14hy.js.map
