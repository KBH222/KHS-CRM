import{j as s}from"./ui-vendor-DuzoyoLP.js";import{r as o}from"./react-vendor-BLXwT7zj.js";import{c as d}from"./customer.service.fixed-BwwfzteX.js";import{g as S,s as i}from"./index-DEcLH6Mq.js";import"./utils-vendor-BiZXfEo0.js";function O(){var h,x;const[l,u]=o.useState([]),[n,p]=o.useState({}),[m,b]=o.useState([]),[v,f]=o.useState([]),t=e=>{const r=new Date().toLocaleTimeString();f(c=>[`[${r}] ${e}`,...c].slice(0,20))},a=async()=>{try{const e=await d.getCustomers();u(e),t(`Loaded ${e.length} customers from service`);const r=await S.getCustomers();b(r),t(`Found ${r.length} customers in IndexedDB`);const c=i.getSyncStatus(),g=i.getPendingOperations();p({...c,pendingOps:g}),t(`Sync queue has ${g.length} operations`)}catch(e){console.error("Failed to load data",e),t(`Error loading data: ${e}`)}};o.useEffect(()=>{a();const e=setInterval(a,2e3);return()=>clearInterval(e)},[]);const j=async()=>{try{const e=await d.createCustomer({name:`Test Customer ${Date.now()}`,address:"123 Test St",phone:"555-0123",email:"test@example.com"});t(`Created customer: ${e.name} (${e.id})`),await a()}catch(e){console.error("Failed to create customer",e),t(`Error creating customer: ${e}`)}},y=async()=>{try{t("Starting force sync...");const e=await i.syncAll();t(`Sync complete: ${e.synced} synced, ${e.failed} failed`),await a()}catch(e){console.error("Force sync failed",e),t(`Sync error: ${e}`)}},N=async()=>{try{t("Refreshing from server..."),await d.refreshFromServer(),t("Server refresh complete"),await a()}catch(e){console.error("Refresh failed",e),t(`Refresh error: ${e}`)}},w=()=>{i.clearQueue(),t("Sync queue cleared"),a()};return s.jsxs("div",{className:"max-w-6xl mx-auto p-4",children:[s.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Sync Debug Dashboard"}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[s.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Status"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Online:"})," ",s.jsx("span",{className:navigator.onLine?"text-green-600":"text-red-600",children:navigator.onLine?"Yes":"No"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Syncing:"})," ",n.syncing?"Yes":"No"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Pending Operations:"})," ",((h=n.pendingOps)==null?void 0:h.length)||0]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Queue Size:"})," ",n.queueSize||0]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[s.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Actions"}),s.jsxs("div",{className:"flex gap-2 flex-wrap",children:[s.jsx("button",{onClick:j,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Create Test Customer"}),s.jsx("button",{onClick:y,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",disabled:!navigator.onLine,children:"Force Sync"}),s.jsx("button",{onClick:N,className:"px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600",disabled:!navigator.onLine,children:"Refresh from Server"}),s.jsx("button",{onClick:w,className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:"Clear Sync Queue"}),s.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Reload Data"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsxs("h2",{className:"text-lg font-semibold mb-2",children:["Service Data (",l.length,")"]}),s.jsx("div",{className:"max-h-60 overflow-auto",children:l.map(e=>s.jsx("div",{className:"text-sm py-1 border-b",children:s.jsxs("span",{className:e.id.startsWith("temp_")?"text-orange-600":"",children:[e.name," - ",e.id]})},e.id))})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsxs("h2",{className:"text-lg font-semibold mb-2",children:["IndexedDB Data (",m.length,")"]}),s.jsx("div",{className:"max-h-60 overflow-auto",children:m.map(e=>s.jsx("div",{className:"text-sm py-1 border-b",children:s.jsxs("span",{className:e.id.startsWith("temp_")?"text-orange-600":"",children:[e.name," - ",e.id]})},e.id))})]})]}),((x=n.pendingOps)==null?void 0:x.length)>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[s.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Pending Operations"}),s.jsx("div",{className:"max-h-40 overflow-auto",children:n.pendingOps.map(e=>s.jsxs("div",{className:"text-sm py-1 border-b font-mono",children:[e.operation," ",e.entityType," ",e.entityId||"new"]},e.id))})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Logs"}),s.jsx("div",{className:"max-h-60 overflow-auto bg-gray-100 p-2 rounded",children:v.map((e,r)=>s.jsx("div",{className:"text-xs font-mono",children:e},r))})]})]})}export{O as default};
//# sourceMappingURL=SyncDebug-aibS-vmy.js.map
